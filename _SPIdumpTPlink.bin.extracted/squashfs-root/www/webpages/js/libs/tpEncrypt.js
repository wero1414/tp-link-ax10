!function(r){var n,o,t;r.encrypt=r.encrypt||{},r.encrypt.MD5=function(t,e){return CryptoJS.MD5(t,e).toString()},r.encrypt.SHA256=function(t){return CryptoJS.SHA256(t).toString()},r.encrypt.rand=function(){var t,e=window.crypto||window.msCrypto;return e&&e.getRandomValues?(t=new Uint32Array(1),e.getRandomValues(t),t[0]/4294967296):Math.random()},r.encrypt.getRandomIntInclusive=function(t,e){t=Math.ceil(t),e=Math.floor(e);return Math.floor(r.encrypt.rand()*(e-t+1))+t},r.encrypt.generateRandomIntString=function(t){for(var e="";t--;)e+=r.encrypt.getRandomIntInclusive(0,9);return e},r.encrypt.AES=(n={mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7},(t=function(){}).prototype.genKey=function(){var t=r.encrypt.generateRandomIntString(16),e=r.encrypt.generateRandomIntString(16);return this.key=t,this._keyUtf8=CryptoJS.enc.Utf8.parse(t),this.iv=e,this._ivUtf8=CryptoJS.enc.Utf8.parse(e),{key:t,iv:e}},t.prototype.setKey=function(t,e){"string"==typeof t&&16==t.length&&(this.key=t,this._keyUtf8=CryptoJS.enc.Utf8.parse(t)),"string"==typeof e&&16==e.length&&(this.iv=e,this._ivUtf8=CryptoJS.enc.Utf8.parse(e))},t.prototype.setStringKey=function(t){var t=t.split("&"),e=t[0].split("=")[1],t=t[1].split("=")[1];this.setKey(e,t)},t.prototype.getKey=function(){return{key:this.key,iv:this.iv}},t.prototype.getKeyString=function(t){return(t=t||"k=%key%&i=%iv%").replace("%key%",this.key).replace("%iv%",this.iv)},t.prototype.encrypt=function(t){var e=r.extend(n,{iv:this._ivUtf8});return CryptoJS.AES.encrypt(t,this._keyUtf8,e).toString()},t.prototype.decrypt=function(t){var e=r.extend(n,{iv:this._ivUtf8});return CryptoJS.AES.decrypt(t,this._keyUtf8,e).toString(CryptoJS.enc.Utf8)},t),r.encrypt.RSA=(o=r.su.encrypt,(t=function(){}).prototype.setKey=function(t,e){this.nn=t,this.ee=e},t.prototype.setStringKey=function(t){var t=t.split("&"),e=t[0].split("=")[1],t=t[1].split("=")[1];this.setKey(e,t)},t.prototype.encrypt=function(t,e,r){return o(t,[this.nn||e,this.ee||r])},t.prototype.getKeyString=function(t){return(t=t||"nn=%nn%&ee=%ee%").replace("%nn%",this.nn).replace("%ee%",this.ee)},t),r.encrypt.encryptor=((t=function(t){this.aes=new r.encrypt.AES,this.rsa=new r.encrypt.RSA}).prototype.setHash=function(){var t,e;2==arguments.length?(t=arguments[0],e=arguments[1],this.hash=r.su.IS_RG_SEC?r.encrypt.SHA256(t+e):r.encrypt.MD5(t+e)):this.hash=arguments[0]},t.prototype.getHash=function(){return this.hash},t.prototype.setSeq=function(t){this.seq=parseInt(t)},t.prototype.getSeq=function(t){return this.seq},t.prototype.genAESKey=function(){this.aes.genKey(),this.aesKeyString=this.aes.getKeyString()},t.prototype.getAESKey=function(){return this.aes.getKeyString()},t.prototype.setAESStringKey=function(t){this.aes.setStringKey(t),this.aesKeyString=t},t.prototype.setRSAKey=function(t,e){this.rsa.setKey(t,e)},t.prototype.setRSAStringKey=function(t){this.rsa.setStringKey(t)},t.prototype.getRSAKey=function(){return this.rsa.getKeyString()},t.prototype.getSignature=function(t,e){r=e?this.aesKeyString+"&h="+this.hash+"&s="+t||this.seq:"h="+this.hash+"&s="+t||this.seq;for(var r,n="",o=0;o<r.length;)n+=this.rsa.encrypt(r.substr(o,53)),o+=53;return n},t.prototype.dataEncrypt=function(t,e){var r={},t=this.aes.encrypt(t),n=t.length;return r.sign=this.getSignature(this.seq+n,e),r.data=t,r},t.prototype.dataDecrypt=function(t){return this.aes.decrypt(t)},t),r.encrypt.encryptManager=((t=function(){}).prototype.genEncryptor=function(){return this.encryptor=new r.encrypt.encryptor,this.encryptor},t.prototype.recordEncryptor=function(){this.encryptor&&(localStorage.setItem("encryptorAES",this.encryptor.getAESKey()),localStorage.setItem("encryptorSeq",this.encryptor.getSeq()),localStorage.setItem("encryptorHash",this.encryptor.getHash()),localStorage.setItem("encryptorRsa",this.encryptor.getRSAKey()))},t.prototype.getEncryptor=function(){return this.encryptor||(this.encryptor=new r.encrypt.encryptor,this.encryptor.setAESStringKey(localStorage.getItem("encryptorAES")),this.encryptor.setSeq(localStorage.getItem("encryptorSeq")),this.encryptor.setHash(localStorage.getItem("encryptorHash")),this.encryptor.setRSAStringKey(localStorage.getItem("encryptorRsa"))),this.encryptor},t.prototype.cleanStorage=function(){localStorage.removeItem("encryptorAES"),localStorage.removeItem("encryptorSeq"),localStorage.removeItem("encryptorHash"),localStorage.removeItem("encryptorRsa")},new t)}(jQuery);