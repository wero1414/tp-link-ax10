!function(s){s.su.moduleManager.define("reboot",{models:["reboot","timeSettings"],stores:["repeatModeStore","rebootWeekdayStore","rebootDateStore"],services:["ajax","device","time"],deps:["main"],views:["rebootView"],listeners:{ev_on_launch:function(e,o,a,t,n,u,s){t.timeSettings.load({success:function(e){"auto"===e.type?(a.rebootView.scheduleAvailableFieldset.show(),a.rebootView.scheduleNotAvailableTips.hide(),t.reboot.load()):(a.rebootView.scheduleAvailableFieldset.hide(),a.rebootView.scheduleNotAvailableTips.show(),o.unRegisterAutoSaveData([t.reboot]))}})},ev_before_destroy:function(e,o){o.beforeDestroy()}},init:function(t,n,u,s,e,i){this.configViews({}),this.listen({"models.reboot.enable":{ev_value_change:function(e,o,a){"on"===o?(n.rebootView.scheduleFieldset.show(),i.time.on("on_time_change",t.onTimeChange),i.time.on("on_hour24_change",t.onHour24Change)):(n.rebootView.scheduleFieldset.hide(),i.time.off("on_time_change",t.onTimeChange),i.time.off("on_hour24_change",t.onHour24Change))}},"models.reboot.cycle":{ev_value_change:function(e,o,a){u.reboot.enable.getValue();"week"===o?(s.rebootWeekdayStore.loadData(t.weekdayData),u.reboot.day.setValue("Mon"),u.reboot.day.show()):"month"===o?(s.rebootWeekdayStore.loadData(t.dateData),u.reboot.day.setValue("1"),u.reboot.day.show()):u.reboot.day.hide()}}}),this.control({"#reboot-button":{ev_button_click:function(){t.startReboot()}}})}},function(e,t,a,o,n,u){return{weekdayData:[{name:s.su.CHAR.REBOOT.MON,value:"Mon",selected:!0},{name:s.su.CHAR.REBOOT.TUE,value:"Tues"},{name:s.su.CHAR.REBOOT.WED,value:"Wed"},{name:s.su.CHAR.REBOOT.THU,value:"Thur"},{name:s.su.CHAR.REBOOT.FRI,value:"Fri"},{name:s.su.CHAR.REBOOT.SAT,value:"Sat"},{name:s.su.CHAR.REBOOT.SUN,value:"Sun"}],dateData:[{value:"1",name:s.su.CHAR.REBOOT["1ST"],selected:!0},{value:"2",name:s.su.CHAR.REBOOT["2ND"]},{value:"3",name:s.su.CHAR.REBOOT["3RD"]},{value:"4",name:s.su.CHAR.REBOOT["4TH"]},{value:"5",name:s.su.CHAR.REBOOT["5TH"]},{value:"6",name:s.su.CHAR.REBOOT["6TH"]},{value:"7",name:s.su.CHAR.REBOOT["7TH"]},{value:"8",name:s.su.CHAR.REBOOT["8TH"]},{value:"9",name:s.su.CHAR.REBOOT["9TH"]},{value:"10",name:s.su.CHAR.REBOOT["10TH"]},{value:"11",name:s.su.CHAR.REBOOT["11TH"]},{value:"12",name:s.su.CHAR.REBOOT["12TH"]},{value:"13",name:s.su.CHAR.REBOOT["13TH"]},{value:"14",name:s.su.CHAR.REBOOT["14TH"]},{value:"15",name:s.su.CHAR.REBOOT["15TH"]},{value:"16",name:s.su.CHAR.REBOOT["16TH"]},{value:"17",name:s.su.CHAR.REBOOT["17TH"]},{value:"18",name:s.su.CHAR.REBOOT["18TH"]},{value:"19",name:s.su.CHAR.REBOOT["19TH"]},{value:"20",name:s.su.CHAR.REBOOT["20TH"]},{value:"21",name:s.su.CHAR.REBOOT["21TH"]},{value:"22",name:s.su.CHAR.REBOOT["22TH"]},{value:"23",name:s.su.CHAR.REBOOT["23TH"]},{value:"24",name:s.su.CHAR.REBOOT["24TH"]},{value:"25",name:s.su.CHAR.REBOOT["25TH"]},{value:"26",name:s.su.CHAR.REBOOT["26TH"]},{value:"27",name:s.su.CHAR.REBOOT["27TH"]},{value:"28",name:s.su.CHAR.REBOOT["28TH"]}],onTimeChange:function(e,o){var a=u.time.getHour24(),o=u.time.format(o,"yyyy-MM-dd HH:mm:ss",a);t.rebootView.currentTime.setValue(o)},onHour24Change:function(e,o){o?a.reboot.time.setHourSystem("24"):a.reboot.time.setHourSystem("12")},beforeDestroy:function(){u.time.off("on_time_change",e.onTimeChange),u.time.off("on_hour24_change",e.onHour24Change)},startReboot:function(){u.ajax.request({proxy:"rebootProxy",success:function(e){var o=1e3*(u.device.getRebootTime()||60);n.main.startReboot(o,function(){localStorage&&localStorage.setItem("token",""),e.loginRemote?location.href="http://"+e.remoteUrl:location.href="http://tplinkwifi.net"})}})}}})}(jQuery);