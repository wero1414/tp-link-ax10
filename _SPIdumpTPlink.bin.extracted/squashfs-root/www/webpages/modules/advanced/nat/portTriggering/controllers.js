!function(s){s.su.moduleManager.define("portTriggering",{deps:[],services:[],models:[],stores:["portTriggeringStore","portTriggeringCommonServicesStore","natProtocolStore"],views:["portTriggeringView"],listeners:{ev_on_launch:function(e,i,o,t,a,r,n){i=this;a.portTriggeringStore.load(),o.portTriggeringView.name.setMaxLength(32),this.control({"#port-triggering-grid":{ev_grid_before_save:function(e,t){for(var r=a.portTriggeringStore.getEditingModel(),n=a.portTriggeringStore.getStoreData(),i=r.triggerPort.getValue(),o=r.triggerProtocol.getValue(),g=0;g<n.length;g++)if(n[g].key!==r.key.getValue()&&n[g].triggerPort===i&&n[g].triggerProtocol===o)return r.triggerPort.setError(""),r.triggerProtocol.setError(s.su.CHAR.PORT_TRIGGERING.CONFLICT_NOTE),t.preventDefault(),!1;return!0}},"#port-triggering-common-service":{ev_button_click:function(e){o.portTriggeringView.portTriggeringCommonService.show()}},"#port-triggering-common-service-kinds":{ev_item_click:function(e,t,r){var n=a.portTriggeringStore.getEditingModel();n.name.setValue(r.name),n.triggerPort.setValue(r.triggerPort),n.triggerProtocol.setValue(r.triggerProtocol),n.externalPort.setValue(r.externalPort),n.externalProtocol.setValue(r.externalProtocol),o.portTriggeringView.portTriggeringCommonService.close()}},"#port-triggering-external-port":{ev_textbox_blur:function(){var e=a.portTriggeringStore.getEditingModel();if(1==e.externalPort.getValid()){for(var t=e.externalPort.getValue().split(","),r="",n=0;n<t.length;n++)r+=i.tansformPort(t[n]),n<t.length-1&&(r+=",");e.externalPort.setValue(r)}}},"#port-triggering-trigger-port":{ev_textbox_blur:function(e,t){var r,n=a.portTriggeringStore.getEditingModel();1==n.triggerPort.getValid()&&(r=n.triggerPort.getValue(),isNaN(parseInt(r,10))||(r=parseInt(r,10)),n.triggerPort.setValue(r))}}}),this.listen({"stores.portTriggeringStore":{ev_data_change:function(e,t,r){t.value!=t.oldValue&&"enable"==r.getName()&&a.portTriggeringStore.sync()}}})}},init:function(e,t,r,n,i,o){this.configViews({id:"portTriggeringView",items:[{id:"port-triggering-grid",configs:{popEditor:{addTitle:s.su.CHAR.PORT_TRIGGERING.POP_TITLE,content:"#port-triggering-grid-pop-editor",fields:[{name:"name"},{name:"triggerPort"},{name:"triggerProtocol"},{name:"externalPort"},{name:"externalProtocol"},{name:"externalPort"},{name:"externalProtocol"},{name:"enable"}]},columns:[{text:s.su.CHAR.PORT_TRIGGERING.SERVICE_NAME,dataIndex:"name"},{text:s.su.CHAR.PORT_TRIGGERING.STATUS,dataIndex:"enable",xtype:"customWidget",widgetName:"switch",cls:"status l-hide xl-hide",settings:{trueValue:"on",falseValue:"off"}},{text:s.su.CHAR.PORT_TRIGGERING.TRIGGERING_PORT,dataIndex:"triggerPort"},{text:s.su.CHAR.PORT_TRIGGERING.TRIGGERING_PROTOCOL,dataIndex:"triggerProtocol",renderer:function(e){return"ALL"==e?s.su.CHAR.PORT_TRIGGERING.ALL:"TCP"==e?s.su.CHAR.PORT_TRIGGERING.TCP:s.su.CHAR.PORT_TRIGGERING.UDP}},{text:s.su.CHAR.PORT_TRIGGERING.EXTERNAL_PORT,dataIndex:"externalPort"},{text:s.su.CHAR.PORT_TRIGGERING.EXTERNAL_PROTOCOL,dataIndex:"externalProtocol",renderer:function(e){return"ALL"==e?s.su.CHAR.PORT_TRIGGERING.ALL:"TCP"==e?s.su.CHAR.PORT_TRIGGERING.TCP:s.su.CHAR.PORT_TRIGGERING.UDP}},{text:s.su.CHAR.PORT_TRIGGERING.STATUS,dataIndex:"enable",xtype:"customWidget",widgetName:"switch",cls:"status s-hide m-hide",settings:{trueValue:"on",falseValue:"off"}},{xtype:"actioncolumn",text:s.su.CHAR.PORT_TRIGGERING.MODIFY,renderer:function(e,t){var r='<a href="javascript:void(0)" class="grid-content-btn grid-content-btn-edit btn-edit">';r+='<span class="icon"></span>';return'<a href="javascript:void(0)" class="grid-content-btn grid-content-btn-edit btn-edit"><span class="icon"></span><span class="text"></span></a><a href="javascript:void(0)" class="grid-content-btn grid-content-btn-delete btn-delete"><span class="icon"></span><span class="text"></span></a>'}}]}},{id:"port-triggering-common-service-kinds",itemRender:function(e,t){var r='<div class="common-service-kinds-layout">';return r+'<div class="common-service-kinds">'+("<span>"+t.name+"</span>")+"</div>"+"</div>"}}]})}},function(e,t,r,n,i,o){return{tansformPort:function(e){var e=e.split("-"),t="";return 1==e.length?isNaN(parseInt(e[0],10))||(t=parseInt(e[0],10)):2!=e.length||isNaN(parseInt(e[0],10))||isNaN(parseInt(e[1],10))||(t=parseInt(e[0],10)+"-"+parseInt(e[1],10)),t}}})}(jQuery);